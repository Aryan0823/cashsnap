<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8">
      <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
      <title>Add Product | Cashsnap</title>
      
      <!-- Favicon -->
      <link rel="shortcut icon" href="/assets/images/favicon.ico" />
      <link rel="stylesheet" href="/assets/css/backend-plugin.min.css">
      <link rel="stylesheet" href="/assets/css/backend.css?v=1.0.0">
      <link rel="stylesheet" href="/assets/vendor/@fortawesome/fontawesome-free/css/all.min.css">
      <link rel="stylesheet" href="/assets/vendor/line-awesome/dist/line-awesome/css/line-awesome.min.css">
      <link rel="stylesheet" href="/assets/vendor/remixicon/fonts/remixicon.css">  </head>
      <body class="  ">
        <div class="content-page">
            <div class="container-fluid add-form-list">
               <div class="row">
                   <div class="col-sm-12">
                       <div class="card">
                           <div class="card-header d-flex justify-content-between">
                               <div class="header-title">
                                   <h4 class="card-title">Add Product</h4>
                               </div>
                           </div>
                           <div class="card-body">
                               <!-- action="page-list-product.html" -->
                               <form data-toggle="validator">
                                   <div class="row">
                                       <div class="col-md-12">
                                           <div class="form-group">
                                               <label>Product Type *</label>
                                               <select name="type" id="productType" class="selectpicker form-control" data-style="py-0">
                                                   <option>Standard</option>
                                                   <option>Combo</option>
                                                   <option>Digital</option>
                                                   <option>Service</option>
                                               </select>
                                           </div> 
                                       </div>  
                                       <div class="col-md-6">                      
                                           <div class="form-group">
                                               <label>Name *</label>
                                               <input type="text" class="form-control" placeholder="Enter Name" data-errors="Please Enter Name." id="name" required>
                                               <div class="help-block with-errors"></div>
                                           </div>
                                       </div>    
                                       <div class="col-md-6">
                                           <div class="form-group">
                                               <label>Code *</label>
                                               <input type="text" class="form-control" placeholder="Enter Code" data-errors="Please Enter Code." id="code" required>
                                               <div class="help-block with-errors"></div>
                                           </div>
                                       </div> 
                                       <div class="col-md-6"> 
                                           <div class="form-group">
                                               <label>Barcode Symbology *</label>
                                               <select name="type" class="selectpicker form-control" id="barcode" data-style="py-0">
                                                   <option>CREM01</option>
                                                   <option>UM01</option>
                                                   <option>SEM01</option>
                                                   <option>COF01</option>
                                                   <option>FUN01</option>
                                                   <option>DIS01</option>
                                                   <option>NIS01</option>
                                               </select>
                                           </div>
                                       </div> 
                                       <div class="col-md-6">
                                           <div class="form-group">
                                               <label>Category *</label>
                                               <select name="type" class="selectpicker form-control" id="category" data-style="py-0">
                                                   <option>Beauty</option>
                                                   <option>Grocery</option>
                                                   <option>Food</option>
                                                   <option>Furniture</option>
                                                   <option>Shoes</option>
                                                   <option>Frames</option>
                                                   <option>Jewellery</option>
                                               </select>
                                           </div>
                                       </div>
                                       <div class="col-md-6">
                                           <div class="form-group">
                                               <label>Cost *</label>
                                               <input type="text" class="form-control" placeholder="Enter Cost" data-errors="Please Enter Cost." id="cost" required>
                                               <div class="help-block with-errors"></div>
                                           </div>
                                       </div>
                                       <div class="col-md-6">
                                           <div class="form-group">
                                               <label>Price *</label>
                                               <input type="text" class="form-control" placeholder="Enter Price" data-errors="Please Enter Price." id="price" required>
                                               <div class="help-block with-errors"></div>
                                           </div>
                                       </div>
                                       <div class="col-md-12">
                                           <div class="form-group">
                                               <label>Tax Method *</label>
                                               <select name="type" id="tax"class="selectpicker form-control" data-style="py-0">
                                                   <option>Exclusive</option>
                                                   <option>Inclusive</option>
                                               </select>
                                           </div>
                                       </div>
                                       <div class="col-md-12">                                    
                                           <div class="form-group">
                                               <label>Quantity *</label>
                                               <input type="text" id="quantity" class="form-control" placeholder="Enter Quantity" required>
                                               <div class="help-block with-errors"></div>
                                           </div>
                                       </div>
                                       <div class="col-md-12">
                                           <div class="form-group">
                                               <label>Image</label>
                                               <input type="file" id="image" class="form-control image-file" name="pic" accept="image/*">
                                           </div>
                                       </div>
                                       <div class="col-md-12">
                                           <div class="form-group">
                                               <label>Description / Product Details</label>
                                               <textarea id="description" class="form-control" rows="4"></textarea>
                                           </div>
                                       </div>
                                   </div>                            
                                   <button id="submit" class="btn btn-primary mr-2">Add Product</button>
                                   <button type="reset" class="btn btn-danger">Reset</button>
                               </form>
                           </div>
                       </div>
                   </div>
                   </div>
               <!-- Page end  -->
               </div>
            </div>
           </div>
           <script type="module">
            // Firebase initialization
            import { initializeApp } from "https://www.gstatic.com/firebasejs/10.8.0/firebase-app.js";
            import { getAnalytics } from "https://www.gstatic.com/firebasejs/10.8.0/firebase-analytics.js";
            import { getFirestore, collection, doc, setDoc } from "https://www.gstatic.com/firebasejs/10.8.0/firebase-firestore.js";
            import { getAuth, onAuthStateChanged } from "https://www.gstatic.com/firebasejs/10.8.0/firebase-auth.js";
        
            const firebaseConfig = {
                apiKey: "AIzaSyBncdnP33SF5gVSACcn2DI7DMZ-eIF3hj4",
                authDomain: "cashsnap-9a185.firebaseapp.com",
                projectId: "cashsnap-9a185",
                storageBucket: "cashsnap-9a185.appspot.com",
                messagingSenderId: "1046320871049",
                appId: "1:1046320871049:web:600b3dee8af7b3c4763858",
                measurementId: "G-5M366WH052"
            };
        
            const app = initializeApp(firebaseConfig);
            const analytics = getAnalytics(app);
            const db = getFirestore(app);
            const auth = getAuth(app);
        
            const name = document.getElementById("name");
            const code = document.getElementById("code");
            const productType = document.getElementById("productType");
            const barcode = document.getElementById("barcode");
            const category = document.getElementById("category");
            const cost = document.getElementById("cost");
            const price = document.getElementById("price");
            const taxMethod = document.getElementById("tax");
            const quantity = document.getElementById("code");
            const image = document.getElementById("image");
            const description = document.getElementById("description");
            const addproduct = document.getElementById("submit");
    
            let grandTotal = 0;
            let currentUser = null;
        
            onAuthStateChanged(auth, (user) => {
                if (user) {
                    currentUser = user;
                } else {
                    // User is signed out
                }
            });
        
        
            let lastClickTime = 0;
        
            function InsertData(code) {
                const currentTime = Date.now();
                if (currentTime - lastClickTime < 1000) {
                    // Ignore multiple clicks within 1 second
                    return;
                }
                lastClickTime = currentTime;
        
                const timestamp = Date.now(); // Get the current timestamp in milliseconds
                const date = new Date(timestamp);
                const formattedDate = `${date.getFullYear()}-${(date.getMonth() + 1).toString().padStart(2, '0')}-${date.getDate().toString().padStart(2, '0')}`;
                const formattedTime = `${date.getHours()}:${date.getMinutes()}:${date.getSeconds()}`;
        
                if (currentUser) {
                    const userRef = doc(db, "Data", currentUser.uid);
                    const productRef = collection(userRef, "products");
                    const productcodeRef = doc(productRef, code);
    
        
                    setDoc(productcodeRef, {
                        Date: formattedDate,
                        Time: formattedTime,
                        Code: code,
                        Name: name,
                        ProductType: productType,
                        Barcode: barcode,
                        Category: category,
                        Cost: cost,
                        Price: price,
                        TaxMethod: taxMethod,
                        Quantity: quantity
                    })
                    .then(() => {
                        alert("Data added successfully");
                    })
                    .catch((error) => {
                        alert(error);
                    });
                } else {
                    alert("Please sign in to add transactions.");
                }
            }
        
            addproduct.addEventListener('click', () => InsertData("code"));
      
    
          </script>
    
         <script>
            let userCreds = JSON.parse(sessionStorage.getItem("user-creds"));
            let userInfo = JSON.parse(sessionStorage.getItem("user-info"));
        
            let GreetHead = document.getElementById('GreetMsg')
            let SignoutButton = document.getElementById('SignOutbtn')
        
            
            let Signout = () => {
                sessionStorage.removeItem("user-creds");
                sessionStorage.removeItem("user-info");
                window.location.href = "./login.html"
            } 
        
            let checkCred = () =>{
                if(!sessionStorage.getItem("user-creds")){
                    window.location.href = "./auth-sign-in.html"
                }
                
                else{
                    // MsgHead.innerText = `user with email ${userCreds.email} and mobile number ${userInfo.mobilenumber}`
                    GreetHead.innerText = `  ${userInfo.firstname}  ${userInfo.lastname}! `
                }
            }
        
            window.addEventListener('load',checkCred);
            SignoutButton.addEventListener('click',Signout);
            </script>
        
        
        <script src="/assets/js/firebaseconfig.js"></script>
        <!-- Backend Bundle JavaScript -->
        <script src="/assets/js/backend-bundle.min.js"></script>
        
        <!-- Table Treeview JavaScript -->
        <script src="/assets/js/table-treeview.js"></script>
        
        <!-- Chart Custom JavaScript -->
        <script src="/assets/js/customizer.js"></script>
        
        <!-- Chart Custom JavaScript -->
        <script async src="/assets/js/chart-custom.js"></script>
        
        <!-- app JavaScript -->
        <script src="/assets/js/app.js"></script>
      </body>
    </html>